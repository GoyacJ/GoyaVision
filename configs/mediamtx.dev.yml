###############################################
# MediaMTX 开发环境配置 (v1.16+)
# GoyaVision - Intelligent Media Processing Platform
#
# 适用场景: 本地开发、调试、功能验证
# 特点: 宽松安全策略、详细日志、无 TLS、低资源占用
###############################################

###############################################
# 全局配置
###############################################

# 日志级别: debug 便于开发调试
logLevel: debug
# 日志输出: 标准输出
logDestinations: [stdout]

# 超时设置 (开发环境适当放宽)
readTimeout: 20s
writeTimeout: 20s
writeQueueSize: 512

# UDP 配置
udpMaxPayloadSize: 1472

# 连接指标 (开发环境启用以便调试)
metrics: no
metricsAddress: :9998

# pprof 性能分析 (开发环境可启用)
pprof: no
pprofAddress: :9999

###############################################
# API 配置
# GoyaVision 通过此 API 管理路径、录制、会话
# 对应 Go 客户端: internal/adapter/mediamtx/client.go
###############################################

api: yes
apiAddress: :9997
# 开发环境不启用 API 加密
apiEncryption: no
apiServerKey: ""
apiServerCert: ""
# 开发环境允许所有来源访问 API (v1.16: 复数形式)
apiAllowOrigins: ['*']
apiTrustedProxies: []

###############################################
# RTSP 配置
# 用途: 拉流/推流源接入 (摄像头、编码器等)
# GoyaVision 通过 AddPath/PatchPath 动态管理 RTSP 源
###############################################

rtsp: yes
rtspAddress: :8554
# 支持所有传输协议便于开发测试 (v1.16: rtspTransports)
rtspTransports: [udp, multicast, tcp]
# 开发环境不加密 (v1.16: rtspEncryption)
rtspEncryption: "no"
rtspServerKey: ""
rtspServerCert: ""
# RTSPS (加密) 端口 - 开发环境不使用
rtspsAddress: :8322
# RTP/RTCP 端口范围
rtpAddress: :8000
rtcpAddress: :8001
multicastIPRange: 224.1.0.0/16
multicastRTPPort: 8002
multicastRTCPPort: 8003

###############################################
# RTMP 配置
# 用途: 流媒体推送接入 (OBS、FFmpeg 等)
###############################################

rtmp: yes
rtmpAddress: :1935
# 开发环境不加密
rtmpEncryption: "no"
rtmpServerKey: ""
rtmpServerCert: ""
rtmpsAddress: :1936

###############################################
# HLS 配置
# 用途: 浏览器端实时播放 (Vue 前端 Video.js 使用)
###############################################

hls: yes
hlsAddress: :8888
# 开发环境不加密
hlsEncryption: no
hlsServerKey: ""
hlsServerCert: ""
# 允许所有来源 (v1.16: 复数形式)
hlsAllowOrigins: ['*']
hlsTrustedProxies: []
# HLS 变体: lowLatency 低延迟模式便于开发体验
hlsVariant: lowLatency
# 分段配置
hlsSegmentCount: 7
hlsSegmentDuration: 1s
hlsPartDuration: 200ms
hlsSegmentMaxSize: 50M
# 不总是重新复用 (按需创建)
hlsAlwaysRemux: no
# HLS 临时文件目录 (空 = 内存)
hlsDirectory: ''

###############################################
# WebRTC 配置
# 用途: 浏览器端超低延迟播放
###############################################

webrtc: yes
webrtcAddress: :8889
# 开发环境不加密
webrtcEncryption: no
webrtcServerKey: ""
webrtcServerCert: ""
# 允许所有来源 (v1.16: 复数形式)
webrtcAllowOrigins: ['*']
webrtcTrustedProxies: []
# 本地 UDP/TCP 地址
webrtcLocalUDPAddress: :8189
webrtcLocalTCPAddress: :8189
# 自动获取本机 IP
webrtcIPsFromInterfaces: yes
webrtcIPsFromInterfacesList: []
# 额外主机地址 (开发环境一般不需要)
webrtcAdditionalHosts: []
# ICE 服务器 (开发环境可不配置 TURN)
webrtcICEServers2: []
# 握手超时
webrtcHandshakeTimeout: 10s
# 单个连接追踪数上限
webrtcTrackGatherTimeout: 2s

###############################################
# SRT 配置
# 用途: 安全可靠传输 (备用协议)
###############################################

srt: yes
srtAddress: :8890

###############################################
# Playback 服务器
# 用途: 录制文件点播回放
###############################################

playback: yes
playbackAddress: :9996

###############################################
# 路径默认配置
# 这些默认值应用于所有通过 API 动态创建的路径
# v1.16: 录制参数从全局移入 pathDefaults
###############################################

pathDefaults:
  # 默认源类型: publisher (等待推流)
  # GoyaVision 创建 pull 源时会通过 API 设置具体 source URL
  source: publisher
  sourceOnDemand: no
  sourceRedirect: ""

  # 录制配置 (v1.16: 从全局移入 pathDefaults)
  # 默认不录制 (由 GoyaVision 按路径动态控制)
  record: no
  # %path = 流路径名 (如 live/camera1-abc123)
  # %Y-%m-%d_%H-%M-%S = 时间戳
  recordPath: ./data/recordings/%path/%Y-%m-%d_%H-%M-%S
  # 录制格式: fmp4 (碎片化 MP4, 支持边录边播)
  recordFormat: fmp4
  # 碎片间隔 (内部分片)
  recordPartDuration: 100ms
  # 分段时长: 开发环境 10 分钟便于快速验证
  recordSegmentDuration: 10m
  # 录制文件保留时长: 0 = 永不自动删除
  recordDeleteAfter: 0s

  # 事件钩子 (开发环境一般留空)
  # GoyaVision 通过 API 动态管理, 不依赖静态钩子
  runOnInit: ""
  runOnInitRestart: no
  runOnDemand: ""
  runOnDemandRestart: no
  runOnReady: ""
  runOnReadyRestart: no
  runOnNotReady: ""
  runOnRead: ""
  runOnReadRestart: no
  runOnUnread: ""
  runOnRecordSegmentCreate: ""
  runOnRecordSegmentComplete: ""

###############################################
# 静态路径配置
# GoyaVision 通过 API 动态管理路径, 此处留空
# 仅需要预定义固定路径时使用
###############################################

paths:
  # 示例: 开发测试用固定路径
  # test:
  #   source: rtsp://admin:admin@192.168.1.100:554/stream1
  #   sourceOnDemand: yes
